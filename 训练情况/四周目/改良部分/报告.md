#### 1.模型训练网络的基本实现与创新性介绍

​																xxxxxxxxxxxxxx

<img src="C:\Users\m\Desktop\训练情况\文档截图样例\1.png" alt="1" style="zoom:50%;" />

​	AM-CNN（基于注意力改进的卷积神经网络）模型是一种用于处理细菌拉曼图谱数据的新型深度学习算法。该模型在输入数据特征组合时，考虑了细菌拉曼图谱的波长向量和强度向量，通过滑动窗口方式获取目标词与周围词的综合向量。首先，通过第一次的注意力机制捕获实体与序列中每个词的相关性，并将其与输入的综合词向量矩阵相乘。接着，对卷积结果使用第二次注意力机制捕获视窗与关系的相关性。最终，将卷积结果与相关性矩阵相乘，得到最后的输出结果。

​	（这个模型的核心在于将细菌拉曼图谱的波长向量和强度向量与输入数据进行组合。首先，将这两种向量进行拼接，构成了最初的输入向量。接着，使用滑动窗口的方式将目标词与周围词组合在一起，形成综合向量。第一次的注意力机制应用在实体与序列中每个词的相关性。将相关性矩阵与输入的综合词向量矩阵相乘，得到一个二维矩阵。然后，使用卷积提取特征，并对卷积结果使用第二次注意力机制捕获视窗与关系的相关性。最后，将卷积结果与相关性矩阵相乘，得到最终的输出结果。通过这种方式，模型能够充分考虑细菌拉曼图谱的波长向量和强度向量在输入数据中的关联关系。）

**网络构建：（需要修改）**

1. 输入层：将细菌拉曼图谱的波长向量和强度向量作为输入数据。波长向量和强度向量可以分别作为两个输入通道。
2. 注意力机制1：使用注意力机制1捕获输入数据中实体与序列中每个词的相关性。可以采用自注意力（self-attention）机制或全局平均池化（global average pooling）等方式。
3. 综合词向量矩阵：将注意力机制1得到的相关性矩阵与输入的综合词向量矩阵相乘，得到一个二维矩阵，用于提取特征。
4. 卷积层：使用卷积层对综合词向量矩阵进行特征提取，可以使用不同的卷积核大小和数量，以捕获不同尺度的特征。
5. 注意力机制2：使用注意力机制2对卷积结果进行进一步的特征选择，捕获视窗与关系的相关性。
6. 全连接层：将经过注意力机制2的卷积结果展平，并通过全连接层进行特征融合和映射，得到最终的输出。
7. 输出层：根据任务需求，可以添加合适的输出层，如softmax层用于分类任务，sigmoid层用于二分类任务等。
8. 损失函数：选择合适的损失函数用于模型的训练和优化。

#### 2.训练数据的预处理准备以及训练流程的介绍

（数据的分组->训练集、验证集、测试集的分配比例：0.8：0.1：0.1->接入神经网络进行epoches=400的预训练->调整训练窗口、学习率等超参数提高模型的泛化性与鲁棒性->......**描述好数据集的大小、特征数量、标签数量、样本分布信息**）



​	我们在训练网络时，为了使得模型可以更快更准确的训练，加入了学习率的自适应调整函数，可以根据训练的数据情况以及已有的训练量来自动调整学习率，使训练效果达到最优。

​	具体模型构架如下：	

1. 我们首先将训练数据集按照4：1划分成训练集与验证集。
2. 构建AM-CNN网络框架
3. 将训练数据输入AM-CNN网络进行1000轮训练
4. 待模型训练好后，使用测试数据测试模型预测结果
5. 调整模型参数，待模型结构最优后，测试模型最终的分类准确度，并记录训练期间 Loss 值的变动情况。



#### 3.训练结果展示+结果解读



- **准确率图**：

  ![ACCURACY](C:\Users\m\Desktop\训练情况\四周目\改良部分\ACCURACY.png)

  ​	我们模型训练的情况可以通过训练加验证准确率图来对于模型的好坏进行综合评估，训练准确率代表模型在当前训练数据上的表现。训练多轮后，训练准确率会逐渐提高，这表明模型学到了更多的数据分类特征。但是，如果训练准确率开始变得非常高，而验证准确率却不再提高，这说明模型开始过拟合训练数据。

  通过不断优化代码的网络结构，将训练的准确率情况效果达到最优

  - 在第356次训练后模型的**训练准确率**维持在100%
  - 在第354次训练后模型的**验证准确率**维持在100%

  ​    这说明AM-CNN机制对于细菌的拉曼光谱数据拟合效果非常理想，与此同时，我们在选取模型的优化器时选取了Adagrad自适应学习率优化器，它可以根据梯度的历史信息自适应地调整学习率，可以对于整体模型提供更好的性能和泛化能力。

- **LOSS图**

![Loss](C:\Users\m\Desktop\训练情况\四周目\改良部分\Loss.png)



通过比较该模型训练过程中的验证损失率与训练损失率情况，我们可以看出：

- **模型分别对于n（6）种细菌数据分类情况与召回情况**

![Train Accuracy](C:\Users\m\Desktop\训练情况\四周目\改良部分\Train Accuracy.png)



- **模型对于测试集的验证情况**



![Test Accuracy](C:\Users\m\Desktop\训练情况\四周目\改良部分\Test Accuracy.png)

分析：



- **ROC曲线**

![ROC曲线](C:\Users\m\Desktop\训练情况\四周目\改良部分\ROC曲线.png)





分析：



综合来看，分类器对于九种细菌的分类效果十分精确，效果最不好的S, aures1细菌的ROC值也高达0.97，说明我们的模型对于细菌的分类实现非常稳定。



为了进一步确定模型在数据不平衡下，